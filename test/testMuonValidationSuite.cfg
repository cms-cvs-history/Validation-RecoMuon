process MuonSuite = {

    source = PoolSource {
        untracked vstring fileNames = { "file:/tmp/jhgoh/ZMM_2_0_6.root" }
    }
    replace PoolSource.fileNames = {
	'/store/relval/2008/6/22/RelVal-RelValSingleMuPt1000-1213987236-IDEAL_V2-2nd/0003/16CB562E-BB40-DD11-B4D9-000423D6CAF2.root',
	'/store/relval/2008/6/22/RelVal-RelValSingleMuPt1000-1213987236-IDEAL_V2-2nd/0003/8E33662C-B940-DD11-BFDE-001617DBD5AC.root',
	'/store/relval/2008/6/22/RelVal-RelValSingleMuPt1000-1213987236-IDEAL_V2-2nd/0004/04B3F7B0-0241-DD11-B234-000423D99264.root'
    }
    
    untracked PSet maxEvents = {untracked int32 input = 100}

#    service = MessageLogger
#    {
#	untracked vstring destinations = { "cout" }
#	untracked vstring categories     = { "RecoMuonValidator" }
#	untracked vstring debugModules   = { "recoMuonValidator" }
#	untracked PSet cout = {
#          untracked string threshold = "DEBUG"
#            untracked bool noLineBreaks = true
#            untracked bool noTimeStamps = true
#            untracked PSet preEventProcessing = { untracked int32 limit = 0 }
#            untracked PSet FwkReport = { untracked int32 limit = 0 }
#            untracked PSet FwkJob    = { untracked int32 limit = 0 }
#            untracked PSet default   = { untracked int32 limit = 0 }
#            untracked PSet RecoMuonValidator = { untracked int32 limit = -1}
#	}
#    }
    
    //include "MagneticField/Engine/data/volumeBasedMagneticField.cfi"
    include "Configuration/StandardSequences/data/Services.cff"
    include "Configuration/StandardSequences/data/MagneticField.cff"
    include "Geometry/CMSCommonData/data/cmsIdealGeometryXML.cff" 
    include "Geometry/CommonDetUnit/data/globalTrackingGeometry.cfi"
    include "RecoMuon/DetLayers/data/muonDetLayerGeometry.cfi"
    
    include "RecoMuon/TrackingTools/data/MuonServiceProxy.cff"

    module cutsTPEfficMu = cutsTPEffic from "Validation/RecoTrack/data/cutsTPEffic.cfi"
    replace cutsTPEfficMu.pdgId = {13, -13}

    include "Validation/RecoMuon/data/TrackAssociatorByPositionDeltaR1.cfi"
    include "Validation/RecoMuon/data/TrackAssociatorByPositionDeltaR2.cfi"

    include "Validation/RecoMuon/data/tpToGlbTrackAssociation.cfi"
    include "Validation/RecoMuon/data/tpToStaTrackAssociation.cfi"
    
    include "Validation/RecoMuon/data/multiGlbTrackValidator.cfi"
    include "Validation/RecoMuon/data/multiStaTrackValidator.cfi"

    include "Validation/RecoMuon/data/glbMuonValidator.cfi"
    include "Validation/RecoMuon/data/staMuonValidator.cfi"

    include "Validation/RecoMuon/data/muonAnalyzers.cff"

    replace glbMuonValidator.simLabel = "cutsTPEfficMu"
    replace staMuonValidator.simLabel = "cutsTPEfficMu"

//    include "SimTracker/TrackAssociation/data/TrackAssociatorByChi2.cfi"
    //include "SimTracker/TrackAssociation/data/TrackAssociatorByHits.cfi"
//    include "SimTracker/TrackAssociation/data/TrackAssociatorByPosition.cff"

//    include "SimTracker/TrackAssociation/data/standAloneMuonsMCMatch.cfi"
//    include "SimTracker/TrackAssociation/data/globalMuonsMCMatch.cfi"
    
    # Track and Particle Collections
    //include "Validation/RecoMuon/data/MuonSeedTrack.cff"

    
    //service = DQMStore{ }

    //include "Validation/RecoMuon/data/RecoMuonValidators.cff"

    //replace recoMuonValidator.outputFileName = "validation.root"
    //replace glbMuonValidator.simLabel = "cutsTPEfficMu"

/////////
    //include "Validation/RecoMuon/data/TrackAssociatorByPositionDeltaR1.cfi"
    //include "Validation/RecoMuon/data/tpToGlbTrackAssociation.cfi"
//
    //include "Validation/RecoMuon/data/MultiGlbTrackValidator.cfi"
    //replace multiGlbTrackValidator.associatormap = tpToGlbTrackAssociation
    //replace multiGlbTrackValidator.associators = {"TrackAssociatorByDeltaR1"}
    //replace multiGlbTrackValidator.out = "validation.root"
/////////

   module MyOut = PoolOutputModule
    {
        untracked string fileName = "test.root"
        untracked vstring outputCommands = {
            "drop *",
	    "keep *_MEtoEDMConverter_*_*",
            "keep recoTracks_standAloneMuons_*_*",
            "keep recoTracks_globalMuons_*_*",
	    "keep *_mergedtruth_MergedTrackTruth_*",
            "keep *_tpToGlbTrackAssociation_*_*",
            "keep *_tpToStaTrackAssociation_*_*"
        }
    }

    include "DQMServices/Components/data/MEtoEDMConverter.cfi"

### Mixing Module
    include "SimGeneral/MixingModule/data/mixNoPU.cfi"
#
### Tracking Particle
# this is ok for Tracker tracks
    include "SimGeneral/TrackingAnalysis/data/trackingParticles.cfi"     
#
# for standAloneMuons
#    replace mergedtruth.TrackerHitLabels  = {"g4SimHitsMuonDTHits","g4SimHitsMuonCSCHits","g4SimHitsMuonRPCHits"}
# for globalMuons
    replace mergedtruth.TrackerHitLabels += "g4SimHitsMuonDTHits"
    replace mergedtruth.TrackerHitLabels += "g4SimHitsMuonCSCHits"
    replace mergedtruth.TrackerHitLabels += "g4SimHitsMuonRPCHits"
    
    sequence My_trackingParticles = {(mix,trackingParticles,cutsTPEfficMu)}
    sequence My_associations = {tpToGlbTrackAssociation,tpToStaTrackAssociation}

    path My_trackingAnalysis = { My_trackingParticles, My_associations }
    path My_validators = { multiGlbTrackValidator & multiStaTrackValidator & glbMuonValidator & staMuonValidator & glbMuonTrackAnalyzer & staMuonTrackAnalyzer }
    path My_MEtoEDM = {MEtoEDMConverter}
    
    endpath output = {MyOut}
    
    schedule = {My_trackingAnalysis, My_validators, output}
}

